<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Egg-ceptional Hard-Boiled Egg Experience</title>
    <meta name="description" content="Discover the joy of the perfect hard-boiled egg! Fun facts, cooking tips, AI-generated egg poetry, and create your own 'Egg-spressions'.">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="icon" href="/generated_images/imagen3_FasjMy_88d4b8_29336df3-e64.png">
    <style>
    body {
        font-family: 'system-ui', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
        background-color: #f4f7f6;
    }

    header h1.display-4 .text-primary {
        font-weight: 500;
    }
    
    #main-egg-image {
        transition: transform 0.3s ease-in-out;
    }
    #main-egg-image:hover {
        transform: scale(1.03);
    }

    #perfect-boil .col-md-4 .p-3 {
        background-color: #f8f9fa;
        transition: box-shadow 0.2s ease-in-out, transform 0.2s ease-in-out;
    }
    #perfect-boil .col-md-4 .p-3:hover {
        box-shadow: 0 .25rem .75rem rgba(0,0,0,.1);
        transform: translateY(-3px);
    }

    #eggFactsCarousel .carousel-item {
        min-height: 120px;
        padding: 20px 50px;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
    }
    #eggFactsCarousel .carousel-item p {
        font-size: 1.15rem;
        font-style: italic;
        color: #495057;
    }
    #eggFactsCarousel .carousel-control-prev-icon,
    #eggFactsCarousel .carousel-control-next-icon {
        background-color: rgba(0, 0, 0, 0.4);
        border-radius: 0.25rem;
    }

    #poemDisplay {
        font-family: 'Georgia', serif;
        font-size: 1.1rem;
        line-height: 1.6;
        color: #333;
    }
    #poemDisplayContainer, #eggSpressionFeedbackContainer {
        position: relative;
    }
    #poemLoader, #eggSpressionLoader {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        z-index: 10;
    }
    #poemDisplay:empty::before {
        content: "Click the button above to summon forth an egg-cellent poem...";
        color: #6c757d;
        font-style: italic;
    }

    #recentEggSpressionsGallery .gallery-item img {
        width: 100%;
        max-width: 120px;
        height: 120px;
        object-fit: cover;
        border: 3px solid #dee2e6;
        border-radius: .25rem;
        cursor: pointer;
        transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
    }
    #recentEggSpressionsGallery .gallery-item img:hover {
        transform: scale(1.05);
        box-shadow: 0 .25rem .75rem rgba(0,0,0,.15);
    }
    
    .btn:focus, .form-control:focus {
        box-shadow: 0 0 0 .25rem rgba(13, 110, 253, .25);
    }
    
    .is-loading #poemDisplay {
        opacity: 0.5;
    }
    </style>
</head>
<body class="bg-light">

    <header class="py-3 mb-4 border-bottom shadow-sm bg-white">
        <div class="container text-center">
            <h1 class="display-4 fw-light text-secondary">The <span class="text-primary">Egg-ceptional</span> Egg</h1>
        </div>
    </header>

    <main class="container my-4">
        <section id="hero-egg" class="text-center mb-5 p-4 bg-white rounded shadow-lg">
            <h2 class="fw-normal mb-3">Behold! The Hard-Boiled Egg.</h2>
            <img id="main-egg-image" src="/generated_images/imagen3_FasjMy_88d4b8_b7a2768e-501.png" class="img-fluid rounded border border-3 border-white" alt="A perfectly cooked hard-boiled egg, sliced in half to show a vibrant yellow yolk." style="max-height: 350px; box-shadow: 0 .5rem 1rem rgba(0,0,0,.15)!important;">
            <p class="lead mt-3 text-muted">Simplicity. Perfection. Protein.</p>
        </section>

        <section id="perfect-boil" class="py-4 px-3 bg-white rounded shadow-sm mb-5">
            <div class="container">
                <div class="text-center mb-4">
                     <img id="egg-timer-icon" src="/generated_images/imagen3_FasjMy_88d4b8_29336df3-e64.png" alt="Egg timer icon" style="height: 40px; margin-right: 10px; vertical-align: middle; display: none;">
                    <h3 class="d-inline-block align-middle text-primary fw-normal">Crafting the Perfect Hard-Boiled Egg</h3>
                </div>
                <div class="row text-center">
                    <div class="col-md-4 mb-3">
                        <div class="p-3 border rounded h-100">
                            <h4 class="h5 text-secondary">Step 1: Gentle Start</h4>
                            <p class="small">Place eggs in a single layer in a saucepan. Add cold water to cover eggs by 1 inch.</p>
                        </div>
                    </div>
                    <div class="col-md-4 mb-3">
                        <div class="p-3 border rounded h-100">
                            <h4 class="h5 text-secondary">Step 2: The Boil & Rest</h4>
                            <p class="small">Bring water to a rolling boil. Cover, remove from heat, and let stand for 10-12 minutes (for large eggs).</p>
                        </div>
                    </div>
                    <div class="col-md-4 mb-3">
                        <div class="p-3 border rounded h-100">
                            <h4 class="h5 text-secondary">Step 3: Cool Down</h4>
                            <p class="small">Transfer eggs to an ice bath for 5-10 minutes to stop cooking and make peeling easier.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="egg-facts" class="py-4 px-3 bg-white rounded shadow-sm mb-5">
            <div class="container">
                <h3 class="text-center mb-4 text-primary fw-normal">Egg-squisite Facts!</h3>
                <div id="eggFactsCarousel" class="carousel slide carousel-fade" data-bs-ride="carousel" data-bs-interval="5000">
                    <div class="carousel-inner text-center p-4 bg-light rounded border" style="min-height: 150px;">
                    </div>
                    <button class="carousel-control-prev" type="button" data-bs-target="#eggFactsCarousel" data-bs-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Previous</span>
                    </button>
                    <button class="carousel-control-next" type="button" data-bs-target="#eggFactsCarousel" data-bs-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Next</span>
                    </button>
                </div>
            </div>
        </section>

        <section id="egg-poem" class="py-4 px-3 bg-white rounded shadow-sm mb-5">
            <div class="container text-center">
                <h3 class="text-center mb-4 text-primary fw-normal">An Ode to the Egg</h3>
                <button id="generatePoemBtn" class="btn btn-outline-primary btn-lg mb-3">Compose an Egg Poem!</button>
                <div id="poemDisplayContainer" class="mt-3" style="min-height: 120px;">
                    <div id="poemLoader" class="spinner-border text-primary" role="status" style="display: none;">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                    <p id="poemError" class="text-danger" style="display: none;"></p>
                    <div id="poemDisplay" class="p-3 border rounded bg-light fst-italic" style="white-space: pre-wrap;">
                    </div>
                </div>
            </div>
        </section>

        <section id="egg-spressions" class="py-4 px-3 bg-white rounded shadow-sm mb-5">
            <div class="container text-center">
                <h3 class="text-center mb-4 text-primary fw-normal">Egg-spressions: Generate Your Own!</h3>
                <div class="row justify-content-center mb-3">
                    <div class="col-md-7 col-lg-6">
                        <div class="input-group">
                            <input type="text" id="eggPromptInput" class="form-control" placeholder="e.g., a happy egg sunbathing">
                            <button id="generateEggSpressionBtn" class="btn btn-primary">Generate!</button>
                        </div>
                         <small class="form-text text-muted d-block mt-1">Describe an egg character or scene. Keep it light-hearted!</small>
                    </div>
                </div>
                <div id="eggSpressionFeedbackContainer" class="my-3" style="min-height: 50px;">
                    <div id="eggSpressionLoader" class="spinner-border text-primary" role="status" style="display: none;">
                        <span class="visually-hidden">Generating Egg-spression...</span>
                    </div>
                    <p id="eggSpressionError" class="text-danger" style="display: none;"></p>
                </div>
                <div id="eggSpressionDisplay" class="my-3">
                    <img id="generatedEggImage" src="#" alt="User-generated egg expression" class="img-fluid rounded shadow-sm border" style="display:none; max-width: 300px; max-height:300px; margin: auto;">
                </div>
                <h4 class="mt-4 fw-normal text-secondary" id="recentGalleryTitle" style="display:none;">Recent Egg-spressions:</h4>
                <div id="recentEggSpressionsGallery" class="row g-2 justify-content-center mt-2">
                </div>
            </div>
        </section>
    </main>

    <footer class="py-4 bg-dark text-white text-center">
        <div class="container">
            <p class="mb-1">&copy; <span id="currentYear"></span> Egg-ceptional Web Works. All rights reserved.</p>
            <p class="mb-0 fst-italic small text-white-50">"The egg, an unassuming powerhouse of culinary potential."</p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
    document.addEventListener('DOMContentLoaded', () => {
        const mainEggImage = document.getElementById('main-egg-image');
        const eggTimerIcon = document.getElementById('egg-timer-icon');
        const generatePoemBtn = document.getElementById('generatePoemBtn');
        const poemDisplayContainer = document.getElementById('poemDisplayContainer');
        const poemDisplay = document.getElementById('poemDisplay');
        const poemLoader = document.getElementById('poemLoader');
        const poemError = document.getElementById('poemError');
        const eggPromptInput = document.getElementById('eggPromptInput');
        const generateEggSpressionBtn = document.getElementById('generateEggSpressionBtn');
        const eggSpressionFeedbackContainer = document.getElementById('eggSpressionFeedbackContainer');
        const eggSpressionLoader = document.getElementById('eggSpressionLoader');
        const eggSpressionError = document.getElementById('eggSpressionError');
        const generatedEggImage = document.getElementById('generatedEggImage');
        const recentEggSpressionsGallery = document.getElementById('recentEggSpressionsGallery');
        const recentGalleryTitle = document.getElementById('recentGalleryTitle');
        const currentYearSpan = document.getElementById('currentYear');
        const eggFactsCarouselInner = document.querySelector('#eggFactsCarousel .carousel-inner');

        if (currentYearSpan) {
            currentYearSpan.textContent = new Date().getFullYear();
        }

        const availableImages = {
            heroEgg: "/generated_images/imagen3_FasjMy_88d4b8_b7a2768e-501.png",
            eggTimer: "/generated_images/imagen3_FasjMy_88d4b8_29336df3-e64.png"
        };

        if (mainEggImage && availableImages.heroEgg && availableImages.heroEgg.startsWith('/generated_images/')) {
            mainEggImage.src = availableImages.heroEgg;
        }

        if (eggTimerIcon && availableImages.eggTimer && availableImages.eggTimer.startsWith('/generated_images/')) {
            eggTimerIcon.src = availableImages.eggTimer;
            eggTimerIcon.style.display = 'inline-block';
        }

        const eggFacts = [
            { fact: "An eggshell can have as many as 17,000 tiny pores, allowing moisture and gases to pass through." },
            { fact: "Brown eggs are not necessarily more nutritious than white eggs; shell color depends on the hen's breed." },
            { fact: "The color of an egg yolk is determined by the hen's diet. More carotenoids mean a darker yolk." },
            { fact: "A large egg contains about 70 calories, 6 grams of high-quality protein, and 13 essential vitamins and minerals." },
            { fact: "To tell if an egg is raw or hard-boiled, spin it! Hard-boiled eggs spin easily, raw eggs wobble." }
        ];

        if (eggFactsCarouselInner) {
            eggFacts.forEach((item, index) => {
                const div = document.createElement('div');
                div.className = `carousel-item${index === 0 ? ' active' : ''}`;
                div.innerHTML = `<p class="mb-0">${item.fact}</p>`;
                eggFactsCarouselInner.appendChild(div);
            });
        }

        if (generatePoemBtn) {
            generatePoemBtn.addEventListener('click', async () => {
                poemLoader.style.display = 'block';
                poemError.style.display = 'none';
                poemDisplay.textContent = '';
                poemDisplayContainer.classList.add('is-loading');
                generatePoemBtn.disabled = true;

                const aiGuidePrompt = "You are a cheerful, slightly whimsical poet. Your task is to compose a short, delightful, family-friendly poem (4-10 lines) about the humble yet wonderful hard-boiled egg. Focus on its simplicity, taste, or versatility.";
                const userMessageForAI = "Please write me a poem about a hard-boiled egg.";

                try {
                    const response = await fetch('/api/ai', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ aiguide: aiGuidePrompt, msgforai: userMessageForAI })
                    });
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    const data = await response.json();
                    if (data.success && data.response) {
                        poemDisplay.textContent = data.response.trim();
                    } else {
                        throw new Error(data.error || "No poem received from AI.");
                    }
                } catch (error) {
                    console.error("Error generating poem:", error);
                    poemError.textContent = "Oops! Couldn't hatch a poem this time. Please try again.";
                    poemError.style.display = 'block';
                    poemDisplay.textContent = "The muse is shy today...";
                } finally {
                    poemLoader.style.display = 'none';
                    poemDisplayContainer.classList.remove('is-loading');
                    generatePoemBtn.disabled = false;
                }
            });
        }

        let recentEggSpressions = [];

        if (generateEggSpressionBtn) {
            generateEggSpressionBtn.addEventListener('click', async () => {
                const userPromptText = eggPromptInput.value.trim();
                if (!userPromptText) {
                    eggSpressionError.textContent = "Please describe your egg-spression!";
                    eggSpressionError.style.display = 'block';
                    setTimeout(() => { eggSpressionError.style.display = 'none'; }, 3000);
                    return;
                }

                eggSpressionLoader.style.display = 'block';
                eggSpressionError.style.display = 'none';
                generatedEggImage.style.display = 'none';
                generateEggSpressionBtn.disabled = true;
                eggPromptInput.disabled = true;

                const apiFullPrompt = `A whimsical, cute, cartoon-style hard-boiled egg character: ${userPromptText}. Light, cheerful background, vibrant colors, expressive face. Focus on the egg.`;

                try {
                    const response = await fetch('/api/generate-image-on-demand', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ prompt: apiFullPrompt, aspectRatio: "1:1" })
                    });
                    const data = await response.json();

                    if (data.success && data.imageUrl) {
                        generatedEggImage.src = data.imageUrl;
                        generatedEggImage.alt = `AI generated egg: ${userPromptText}`;
                        generatedEggImage.style.display = 'block';
                        addImageToRecentGallery(data.imageUrl, userPromptText);
                        eggPromptInput.value = '';
                    } else {
                        throw new Error(data.error || "Failed to generate image. The egg-magination machine is resting.");
                    }
                } catch (error) {
                    console.error("Error generating egg-spression:", error);
                    eggSpressionError.textContent = error.message;
                    eggSpressionError.style.display = 'block';
                } finally {
                    eggSpressionLoader.style.display = 'none';
                    generateEggSpressionBtn.disabled = false;
                    eggPromptInput.disabled = false;
                }
            });
        }

        function addImageToRecentGallery(imageUrl, altText) {
            if (!recentEggSpressionsGallery) return;

            recentEggSpressions.unshift({ url: imageUrl, alt: `Generated egg: ${altText}` });
            if (recentEggSpressions.length > 3) {
                recentEggSpressions.pop();
            }

            recentEggSpressionsGallery.innerHTML = '';
            recentEggSpressions.forEach(imgData => {
                const colDiv = document.createElement('div');
                colDiv.className = 'col-auto gallery-item';
                const imgElement = document.createElement('img');
                imgElement.src = imgData.url;
                imgElement.alt = imgData.alt;
                imgElement.className = 'img-thumbnail';
                imgElement.onclick = () => {
                    generatedEggImage.src = imgData.url;
                    generatedEggImage.alt = imgData.alt;
                    generatedEggImage.style.display = 'block';
                    const yOffset = -100; 
                    const y = generatedEggImage.getBoundingClientRect().top + window.pageYOffset + yOffset;
                    window.scrollTo({top: y, behavior: 'smooth'});
                };
                colDiv.appendChild(imgElement);
                recentEggSpressionsGallery.appendChild(colDiv);
            });
            if (recentEggSpressions.length > 0 && recentGalleryTitle) {
                recentGalleryTitle.style.display = 'block';
            }
        }
    });
    </script>
<!-- Injectable Console Log Copier Snippet --><div id="appgen2025ConsoleCopyUtil" style="position: fixed; top: 5px; right: 5px; z-index: 9999; padding: 5px; background-color: rgba(0,0,0,0.7); border-radius: 5px; cursor: default;" title="Copy Console Logs for this Tab"><button type="button" style="background: none; border: 1px solid #fff; color: #fff; padding: 3px 8px; font-size: 10px; border-radius: 3px; cursor: pointer;">Copy Logs</button></div><script>(function() { const utilContainer = document.getElementById('appgen2025ConsoleCopyUtil'); if (utilContainer) { const originalConsoleLog = console.log; const originalConsoleError = console.error; const originalConsoleWarn = console.warn; const originalConsoleInfo = console.info; const originalConsoleDebug = console.debug; const logs = []; function formatLog(type, args) { const timestamp = new Date().toISOString(); const message = Array.from(args).map(arg => { try { if (arg instanceof Error) return arg.stack || arg.toString(); if (typeof arg === 'object' && arg !== null) { const getCircularReplacer = () => { const seen = new WeakSet(); return (key, value) => { if (typeof value === "object" && value !== null) { if (seen.has(value)) { return "[Circular]"; } seen.add(value); } return value; }; }; return JSON.stringify(arg, getCircularReplacer(), 2); } return String(arg); } catch (e) { return '[Unserializable Object]'; } }).join(' '); return `[${timestamp}] [${type.toUpperCase()}] ${message}`; } console.log = function(...args) { const formatted = formatLog('log', args); logs.push(formatted); originalConsoleLog.apply(console, args); }; console.error = function(...args) { const formatted = formatLog('error', args); logs.push(formatted); originalConsoleError.apply(console, args); }; console.warn = function(...args) { const formatted = formatLog('warn', args); logs.push(formatted); originalConsoleWarn.apply(console, args); }; console.info = function(...args) { const formatted = formatLog('info', args); logs.push(formatted); originalConsoleInfo.apply(console, args); }; console.debug = function(...args) { const formatted = formatLog('debug', args); logs.push(formatted); originalConsoleDebug.apply(console, args); }; window.onerror = function(message, source, lineno, colno, error) { const errorObj = error || {}; const formatted = formatLog('uncaught_error', [message, `at ${source}:${lineno}:${colno}`, errorObj.stack || '(no stack)']); logs.push(formatted); originalConsoleError.call(console, 'Uncaught Error:', message, 'at', source + ':' + lineno + ':' + colno, error); return false; }; window.onunhandledrejection = function(event) { const reason = event.reason || {}; const formatted = formatLog('unhandled_rejection', [reason.message || reason, reason.stack || '(no stack)']); logs.push(formatted); originalConsoleError.call(console, 'Unhandled Rejection:', event.reason); }; const copyButton = utilContainer.querySelector('button'); if (copyButton) { copyButton.addEventListener('click', function(e) { e.stopPropagation(); if (logs.length === 0) { alert('No console logs captured yet to copy.'); return; } const logText = logs.join('\n'); navigator.clipboard.writeText(logText).then(function() { const originalText = copyButton.textContent; copyButton.textContent = 'Copied!'; copyButton.style.background = '#28a745'; copyButton.style.borderColor = '#28a745'; setTimeout(function() { copyButton.textContent = originalText; copyButton.style.background = 'none'; copyButton.style.borderColor = '#fff'; }, 2000); originalConsoleInfo.call(console, 'AppGen2025 Util: Console logs copied to clipboard.'); }).catch(function(err) { originalConsoleError.call(console, 'AppGen2025 Util: Failed to copy console logs - ', err.name, err.message); alert('Failed to copy logs. See browser console for details. Logs may be too large or permissions denied.'); const originalText = copyButton.textContent; copyButton.textContent = 'Failed!'; copyButton.style.background = '#dc3545'; copyButton.style.borderColor = '#dc3545'; setTimeout(function() { copyButton.textContent = originalText; copyButton.style.background = 'none'; copyButton.style.borderColor = '#fff'; }, 3000); }); }); } } else { console.error('AppGen2025 Util: Container element "appgen2025ConsoleCopyUtil" not found.'); } })();</script><!-- End of Injectable Snippet -->
</body>
</html>